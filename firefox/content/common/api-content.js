/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(){var a="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd=window.webmynd||{};window.webmynd[a]=window.webmynd[a]||{};window.webmynd[a].inPage={};window.webmynd[a].onLoad=[];if(!JSON.stringify&&JSON.encode){JSON.stringify=JSON.encode}window.webmynd[a].api=window.webmynd[a].inPage.api={getPref:function(b,c){window.webmynd[a].utils.getPrefs([b],c)},setPref:function(b,c){return window.webmynd[a].utils.setPrefs({name:c})},getPage:window.webmynd[a].utils.getUrl,ajax:function(b){window.webmynd[a].utils.doAjax(b,function(c){if(c.success){b.success(c.data,c.textStatus)}else{b.error(c.textStatus,c.errorThrown)}})},getURL:function(b,c){c(window.webmynd[a].services.getURL(b))},openWindow:function(c,b,e){var d=window.webmynd[a].inPage.utils.makeHiddenNode().attr("class","openWindow");window.webmynd[a].inPage.utils.commsNode().append(d);d.text(JSON.stringify({url:c,name:b,specs:e}));window.webmynd[a].inPage.utils.click(d.get(0),document)},listen:function(b,c){},broadcast:function(b,c,d){},broadcastBackground:function(b,c,d){window.webmynd[a].utils.broadcastBackground({broadcastType:b,content:c},d)},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=Math.random()*16|0,b=e=="x"?d:(d&3|8);return b.toString(16)}).toUpperCase()},log:function(c,b){if(window.console!==undefined&&console.log){var d=c;if(b){d+="\n\tname:"+b.name+"\n\tmessage:"+b.message;if(b.fileName){d+="\n\tfile:"+b.fileName}if(b.lineNumber){d+="\n\tline:"+b.lineNumber}}console.log("["+a+"] "+d)}},beforeLoad:function(b){window.webmynd[a].services.beforeLoad(b)},button:window.webmynd[a].button,prefs:{get:function(b,c){window.webmynd[a].utils.getPrefs([b],function(d){c&&c(d[b])})},set:function(b,c){var d={};d[b]=c;window.webmynd[a].utils.setPrefs(d)},keys:function(b){window.webmynd[a].utils.prefKeys(function(c){b&&b(c)})},clear:function(b,c){window.webmynd[a].utils.prefClear([b],function(){c&&c()})},clearAll:function(b){window.webmynd[a].utils.prefClearAll(function(){b&&b()})}},getPref:function(b,c){this.prefs.get(b,c)},setPref:function(b,c){this.prefs.set(b,c)}};window.webmynd[a].inPage.utils={_typeOf:function(c){var b=typeof c;if(b==="object"){if(c){if(c instanceof Array){b="array"}}else{b="null"}}return b},_toJSON:function(c){var b=function(){return(typeof(c)!="string"&&typeof(window.webmynd[a].$.parseJSON(JSON.stringify(c)))=="string")||(typeof(c)=="string"&&window.webmynd[a].$.parseJSON(JSON.stringify(c))!=c)};if(b()){return window.webmynd[a].$.parseJSON(JSON.stringify(c))}else{return JSON.stringify(c)}},_encode:function(b){return encodeURIComponent(window.webmynd[a].inPage.utils._toJSON(b))},_decode:function(b){return window.webmynd[a].$.parseJSON(decodeURIComponent(b))},fixEvent:function(b){if(typeof(ActiveXObject)!="undefined"){b=b||window.event;b.target=b.target||b.srcElement}return b},commsNode:function(){return window.webmynd[a].$(".wmWrapper."+a).first()},makeHiddenNode:function(){return window.webmynd[a].$("<a></a>")},click:function(c,d){if(d.createEvent){var b=d.createEvent("MouseEvents");b.initMouseEvent("click",true,false,d.defaultView,0,0,0,0,0,false,false,false,false,0,null);c.dispatchEvent(b)}else{if(d.createEventObject){c.fireEvent("onclick",d.createEventObject())}else{throw"Cannot generate click event"}}},handleClick:function(e,c,f,b){function d(i,h,g){if(i.addEventListener){i.addEventListener(h,g,true)}else{if(i.attachEvent){i.attachEvent("on"+h,g)}else{throw"Cannot attach event"}}}d(e,"click",function(g){var h=window.webmynd[a].$(window.webmynd[a].inPage.utils.fixEvent(g).target);if(h.is(c)){if(!f){if(e.detachEvent){e.detachEvent("onclick",arguments.callee);arguments.callee=null}else{e.removeEventListener("click",arguments.callee,true)}}b(g);h.remove()}})},wrap:function(){try{return arguments[0].apply(this,Array.prototype.slice.call(arguments).slice(2))}catch(b){window.webmynd[a].api.log("Exception in "+arguments.callee.name,b)}},};window.webmynd[a].inPage.preferences={get:function(c,b){var e="wmGetPrefs";var d=window.webmynd[a].inPage.utils.makeHiddenNode();d.get(0).innerHTML=window.webmynd[a].inPage.utils._encode(c);d.attr("class",e);window.webmynd[a].inPage.utils.commsNode().append(d);window.webmynd[a].inPage.utils.handleClick(d.get(0),"."+e+"Response",false,function(h){var f=window.webmynd[a].inPage.utils._decode(window.webmynd[a].inPage.utils.fixEvent(h).target.innerHTML);window.webmynd[a].$(h.target).remove();var g=b(f);return g});window.webmynd[a].inPage.utils.click(d.get(0),document)},set:function(c,e){var d=window.webmynd[a].inPage.utils.makeHiddenNode();if(window.webmynd[a].inPage.utils._typeOf(e)==="array"){var f=encodeURIComponent('{"'+c+'": '+window.webmynd[a].inPage.utils._toJSON(e)+"}")}else{var b={};b[c]=e;var f=window.webmynd[a].inPage.utils._encode(b)}d.get(0).innerHTML=f;d.attr("class","wmSetPrefs");window.webmynd[a].inPage.utils.commsNode().append(d);window.webmynd[a].inPage.utils.click(d.get(0),document)}}})();