/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(){var a="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd=window.webmynd||{};window.webmynd[a]=window.webmynd[a]||{};window.webmynd[a].contentScript={};var c=window;var b=document;var d=false;window.webmynd[a].onStart=[];
/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(g,f,h){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";var g=g||window;var f=f||document;background_window=window;window=g;window.webmynd=window.webmynd||{};window.webmynd[e]=window.webmynd[e]||{};window.webmynd[e].services={port_listeners:[],contentScript:{port_listeners:[]},responses:[],console:{consoleService:Components.classes["@mozilla.org/consoleservice;1"].getService(Components.interfaces.nsIConsoleService),log:function(i){window.webmynd[e].services.console.consoleService.logStringMessage(i)}},prefs:Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService),_myPrefs:Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefService).getBranch("extensions."+e+"."),newXHR:function(){return Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance()},getLocalPref:function(l,m,n){var k=window.webmynd[e].services._myPrefs,i=null,j=null;try{j=k.getCharPref(l)}catch(o){window.webmynd[e].services.console.log("No such local preference: "+l);return n(i)}i=JSON.parse(decodeURIComponent(j));n(i)},setLocalPref:function(j,k,l){var i=window.webmynd[e].services._myPrefs;i.setCharPref(j,encodeURIComponent(JSON.stringify(l)))},getLocalKeys:function(k){var i=window.webmynd[e].services._myPrefs,j=i.getChildList("",{});k&&k(j);return j},clearLocalKey:function(j){var i=window.webmynd[e].services._myPrefs;try{i.clearUserPref(j)}catch(k){}},backgroundOpenUrl:function(j){var i=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow("navigator:browser");i.gBrowser.selectedTab=i.gBrowser.addTab(j)},readFile:function(k){var m="";var i=Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);var j=Components.classes["@mozilla.org/intl/converter-input-stream;1"].createInstance(Components.interfaces.nsIConverterInputStream);i.init(k,-1,0,0);j.init(i,"UTF-8",0,0);var n={},l=0;do{l=j.readString(4294967295,n);m+=n.value}while(l!=0);j.close();return m},insertScriptsOnce:function(o,k,n){oldscripts=o.getElementsByTagName("head")[0].getElementsByTagName("script");var j=oldscripts.length;var m;for(var l=0;l<j;l++){m=oldscripts[j-l-1];m.getAttribute("class")==("wmScripts "+e)&&o.getElementsByTagName("head")[0].removeChild(m)}var p=function(q){var i=o.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("class","wmScripts "+e);i.innerHTML=window.webmynd[e].services.readFile(q);o.getElementsByTagName("head")[0].appendChild(i)};if(Components.classes["@mozilla.org/extensions/manager;1"]){setTimeout(function(){var s=Components.classes["@mozilla.org/extensions/manager;1"].getService(Components.interfaces.nsIExtensionManager);for(var r=0;r<k.length;r++){var q=s.getInstallLocation("disconnect@disconnect.me").getItemFile("disconnect@disconnect.me","content/"+k[r]);p(q)}},25)}else{Components.utils["import"]("resource://gre/modules/AddonManager.jsm");AddonManager.getAddonByID("disconnect@disconnect.me",function(i){setTimeout(function(){for(var r=0;r<k.length;r++){var q=i.getResourceURI("content/"+k[r]).QueryInterface(Components.interfaces.nsIFileURL).file;p(q)}},25)})}},getOldUsername:function(){var j=Components.classes["@mozilla.org/file/directory_service;1"].getService(Components.interfaces.nsIProperties).get("ProfD",Components.interfaces.nsIFile);j.append("credentials");var i=window.webmynd[e].services.readFile(j);return(i&&i.split(",")[0])||false},sendRequestToTabs:function(o,q){function k(r,s){for(var i=0;i<r.webmynd[e].services.onRequest.listeners.length;i++){r.webmynd[e].services.onRequest.listeners[i](s)}}var p=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getEnumerator(null);while(p.hasMoreElements()){var n=p.getNext();if(!n.webmynd||!n.webmynd[e]){continue}if(o.port&&n.webmynd[e].contentScript&&n.webmynd[e].contentScript.webmynd&&n.webmynd[e].contentScript.webmynd[e]&&n.webmynd[e].contentScript.webmynd[e].services.port_listeners[o.port]){var l=n.webmynd[e].contentScript.webmynd[e].services.port_listeners;for(var j=0;j<l[o.port].length;j++){l[o.port][j](o.body)}}for(var j=0;j<n.gBrowser.browsers.length;j++){var m=n.gBrowser.browsers[j].contentWindow;if(m.webmynd&&m.webmynd[e]){k(m,o)}}}},sendRequestToFocussedTab:function(n,o){var m=Components.classes["@mozilla.org/appshell/window-mediator;1"].getService(Components.interfaces.nsIWindowMediator).getMostRecentWindow(null);if(!m.webmynd||!m.webmynd[e]){window.webmynd[e].services.console.log("WebMynd platform not attached to current window");return}var j=m.gBrowser.selectedBrowser,l=j.contentWindow;if(l.webmynd&&l.webmynd[e]){for(var k=0;k<l.webmynd[e].services.onRequest.listeners.length;k++){l.webmynd[e].services.onRequest.listeners[k](n)}}},sendRequest:function(l,j){for(var k=0;k<background_window.webmynd[e].services.onRequest.listeners.length;k++){background_window.webmynd[e].services.onRequest.listeners[k](l,null,j)}},onRequest:{listeners:[],addListener:function(i){window.webmynd[e].services.onRequest.listeners.push(i)}},connect:function(j){function n(o,p){var i=this;i.name=o;i.fgToBg=p;i.sibling=null;i.listeners=[];i.onMessage={addListener:function(q){i.listeners.push(q)}};i.postMessage=function(q){i.sibling._postMessageImpl(q)};i._postMessageImpl=function(q){i.listeners.forEach(function(r){r(q)})}}var m=new n(j.name,true),l=new n(j.name,false);m.sibling=l;l.sibling=m;if(h){for(var k=0;k<background_window.webmynd[e].services.onConnect.listeners.length;k++){background_window.webmynd[e].services.onConnect.listeners[k](l)}}else{for(var k=0;k<window.webmynd[e].services.onConnect.listeners.length;k++){window.webmynd[e].services.onConnect.listeners[k](m)}}return(h?m:l)},onConnect:{listeners:[],addListener:function(i){window.webmynd[e].services.onConnect.listeners.push(i)}},getURL:function(i){if(i.slice(0,1)=="/"){return("resource://"+e+i)}else{return("resource://"+e+"/"+i)}},button:{setIcon:function(i){document.getElementById(e+"-image").setAttribute("src",i.url)},setUrl:function(i){},onClicked:{listeners:[],addListener:function(i){window.webmynd[e].services.button.onClicked.listeners.push(i)}},click:function(){for(var j=0;j<window.webmynd[e].services.button.onClicked.listeners.length;j++){window.webmynd[e].services.button.onClicked.listeners[j]()}}},beforeLoad:function(i){i(evt)}}})(c,b,d);
/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(g,f){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";var g=g||window;var f=f||document;window=g;window.webmynd=window.webmynd||{};window.webmynd[e]=window.webmynd[e]||{};window.webmynd[e].utils={__sendRequestWrapper:function(i,h){if(typeof(h)!=="undefined"){window.webmynd[e].services.sendRequest(i,h)}else{window.webmynd[e].services.sendRequest(i)}},getPrefs:function(i,h){this.__sendRequestWrapper({header:{type:"GetPrefs"},names:i},h)},setPrefs:function(h){this.__sendRequestWrapper({header:{type:"SetPrefs"},pairs:h})},prefKeys:function(h){this.__sendRequestWrapper({header:{type:"Prefs-Keys"}},h)},prefClear:function(i,h){this.__sendRequestWrapper({header:{type:"Prefs-Clear"},names:i},h)},prefClearAll:function(h){this.__sendRequestWrapper({header:{type:"Prefs-ClearAll"}},h)},getUrl:function(h,i){this.__sendRequestWrapper({header:{type:"GetUrl"},url:h},i)},openWindow:function(i,h,j){this.__sendRequestWrapper({header:{type:"OpenWindow"},url:i,name:h,specs:j})},doAjax:function(i,h){this.__sendRequestWrapper({header:{type:"DoAjax"},options:i},h)},broadcast:function(i,h){var j=window.webmynd[e].services.connect({name:"broadcast"});h&&j.onMessage.addListener(function(k){h(k)});j.postMessage({header:{type:"Broadcast"},body:i})},broadcastBackground:function(i,h){var j=window.webmynd[e].services.connect({name:"broadcast-priv"});h&&j.onMessage.addListener(function(k){h(k)});j.postMessage({header:{type:"BroadcastPriv"},body:i})},button:{setIcon:function(h){window.webmynd[e].services.sendRequest({header:{type:"Button-SetIcon"},options:h})},setUrl:function(h){window.webmynd[e].services.sendRequest({header:{type:"Button-SetUrl"},options:h})}},completeLinks:function(h){var i=function(j){var k=new RegExp(j);return k.test(h)};if(["^http://.*","^https://.*","^resource://.*","^safari-extension://.*","^chrome.*"].some(i)){return h}else{return window.webmynd[e].services.getURL(h)}}};window.webmynd[e].broadcast={init:function(){var h={broadcast:function(k,i){var j=window.webmynd[e].$('<a class="listenResponse"></a>',f);j.text(JSON.stringify(k.body));window.webmynd[e].view.commsNode().append(j);window.webmynd[e].view.handleClick(j.get(0),".listenResponseResponse",false,function(m){var l=JSON.parse(window.webmynd[e].$(m.target,f).text());i(l.response)});window.webmynd[e].view.click(j.get(0))}};window.webmynd[e].services.onRequest.addListener(function(k,j,i){if(k.header&&(k.header.type==="Broadcast"||k.header.type==="ToFocussed")){h.broadcast(k,i)}})}};window.webmynd[e].pageTools={aznLink:function(l,m){var h={"default":{tag:"webmynd-20",domain:"www.amazon.com"},FR:{tag:"web07c-21",domain:"www.amazon.fr"},CA:{tag:"web0d1-20",domain:"www.amazon.ca"},DE:{tag:"web02a-21",domain:"www.amazon.de"},IT:{tag:"web055-21",domain:"www.amazon.it"},GB:{tag:"web000e-21",domain:"www.amazon.co.uk"}};var k=function(o){var q="/gp/redirect.html?",s=h[m],n=h["default"].tag,p=h["default"].domain;if(s&&s.tag&&s.domain){n=s.tag;p=s.domain}var r={camp:"1789",creative:"9325",tag:n,location:o,ie:"UTF8",linkCode:"ur2"};return"http://"+p+q+window.webmynd[e].$.param(r)};for(var j in h){var i=window.webmynd[e].$(l).attr("href");if(i&&i.indexOf("http://"+h[j].domain+"/")>=0){window.webmynd[e].$(l).attr("href",k(window.webmynd[e].$(l).attr("href")))}}},prepare:function(h,i){window.webmynd[e].$("a",h).each(function(){window.webmynd[e].pageTools.aznLink(this,i._wmCountry)})}}})(c,b);
/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd=window.webmynd||{};window.webmynd[e]=window.webmynd[e]||{};window.webmynd[e].model={hour:0,init:function(f){window.webmynd[e].model._defaultHost="http://www.webmynd.com";window.webmynd[e].model._defaults={};window.webmynd[e].model._remoteCache={};window.webmynd[e].model.setPrefs(f,true);if(!window.webmynd[e].model._defaults.resources){window.webmynd[e].model._defaults.resources={}}window.webmynd[e].model._defaults.resources._wmCountry={type:"remote",url:"/locate"};window.webmynd[e].model.getResources();window.webmynd[e].model.hour=new Date().getHours()},reGetResources:function(){var f=new Date().getHours();if(f>window.webmynd[e].model.hour||(f==0&&window.webmynd[e].model.hour==23)){window.webmynd[e].model.getResources()}window.webmynd[e].model.hour=f},processRemoteResource:function(f){return function(g){if(g){window.webmynd[e].model._remoteCache[f]=g}}},_getResource:function(g){var h=new RegExp("^http:|^https:"),i=new Date().getTime(),f=h.test(window.webmynd[e].model._defaults.resources[g].url)?window.webmynd[e].model._defaults.resources[g].url:window.webmynd[e].model._defaultHost+window.webmynd[e].model._defaults.resources[g].url+"?"+i;window.webmynd[e].model.getUrl(f,window.webmynd[e].model.processRemoteResource(g))},getResources:function(){for(var f in window.webmynd[e].model._defaults.resources){if(window.webmynd[e].model._defaults.resources[f].type&&window.webmynd[e].model._defaults.resources[f].type.match("remote")){window.webmynd[e].model._getResource(f)}}},getPrefs:function(i,g){var h=0,f={};i.forEach(function(j){window.webmynd[e].model._getPref(j,function(k){f[j]=k;h+=1;if(h>=i.length){g(f)}})})},_getPref:function(h,g){var f=null;if(window.webmynd[e].model._defaults.resources[h]&&window.webmynd[e].model._defaults.resources[h].type&&window.webmynd[e].model._defaults.resources[h].type.match("remote")){if(!window.webmynd[e].model._remoteCache[h]){window.webmynd[e].model._getResource(h)}f=window.webmynd[e].model._remoteCache[h];window.webmynd[e].model.reGetResources();return g(f)}else{var i;if(window.webmynd[e].model._defaults.resources[h]){i=window.webmynd[e].model._defaults.resources[h].type}window.webmynd[e].services.getLocalPref(h,i,function(j){if(j===null&&typeof(window.webmynd[e].model._defaults[h])!=="undefined"){j=window.webmynd[e].model._defaults[h]}return g(j)})}},setPrefs:function(i,h){for(var f in i){var g=i[f];if(h){window.webmynd[e].model._defaults[f]=g}else{var j;if(window.webmynd[e].model._defaults.resources[f]){j=window.webmynd[e].model._defaults.resources[f].type}window.webmynd[e].services.setLocalPref(f,j,g)}}},prefs:{keys:function(f){return window.webmynd[e].services.getLocalKeys(f)},clear:function(g,h){for(var f=0;f<g.length;f++){if(g[f].slice(0,3)!=="_wm"){window.webmynd[e].services.clearLocalKey(g[f])}}h&&h(f)},clearAll:function(f){this.clear(this.keys(),f)}},getUrl:function(f,g){var h=window.webmynd[e].services.newXHR();h.onload=function(){if(h.readyState==4){if((h.status>=200&&h.status<300)||h.status==304){g(h.responseText)}else{g(h.responseText);window.webmynd[e].services.console.log("Status code: "+h.status+" from: "+f)}h=null}};h.open("GET",f);h.send(null)},doAjax:function(g,f){g.success=function(i,j,h){f({success:true,data:i,textStatus:j})};g.error=function(h,j,i){f({success:false,textStatus:j,errorThrown:i})};g.dataType="text";window.webmynd[e].$.ajax(g)}}})();(function(){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd=window.webmynd||{};window.webmynd[e]=window.webmynd[e]||{};window.webmynd[e].userData={disconnect_data:{SERVICES:[["Digg",["digg.com"]],["Facebook",["facebook.com","facebook.net","fbcdn.net"]],["Google",["google.com","2mdn.net","doubleclick.net","feedburner.com","gmodules.com","google  analytics.com","googleadservices.com","googlesyndication.com"],["adwords","checkout","chrome","code","docs","feedburner","groups","health","knol","mail","picasaweb","sites","sketchup","wave"],["accounts","analytics","bookmarks","calendar","finance","ig","latitude","reader","voice","webmasters","adsense","alerts","cse","dfp","friendconnect","local","merchants","notebook","support"],"https://www.google.com/"],["Twitter",["twitter.com","twimg.com"]],["Yahoo",["yahoo.com"],["address","answers","apps","buzz","calendar","edit","finance","games","groups","hotjobs","local","mail","my","notepad","pulse","shine","sports","upcoming","webmessenger","www","alerts","autos","avatars","help","login","messages","pipes","realestate","smallbusiness","travel","widgets"],[],"https://search.yahoo.com/"]],BLOCKED_NAME:"Blocked",REQUEST_COUNTS:{}},activations:[{patterns:[""],scripts:["common/lib/jquery-tools-1.2.5.webmynd.min.js","common/api-2b74ff14-7256-42e0-9bf1-0806eec78788.js","2b74ff14-7256-42e0-9bf1-0806eec78788/in-page.js"],styles:["2b74ff14-7256-42e0-9bf1-0806eec78788/popup.css"],allowedRemote:[],htmlSnippets:{"disconnect-popup":"2b74ff14-7256-42e0-9bf1-0806eec78788/popup.html"}}],body:"<div class='wmWrapper'></div>"}})();
/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd=window.webmynd||{};window.webmynd[e]=window.webmynd[e]||{};window.webmynd[e].bg={};window.webmynd[e].onLoad=[];if(!JSON.stringify&&JSON.encode){JSON.stringify=JSON.encode}window.webmynd[e].api=window.webmynd[e].bg.api={getPage:function(g,f){window.webmynd[e].model.getUrl(g,f)},ajax:function(f){var g=function(){};f.success=f.success||g;f.error=f.error||g;window.webmynd[e].model.doAjax(f,function(h){if(h.success){try{var i=window.webmynd[e].$.parseJSON(h.data)}catch(j){try{var i=window.webmynd[e].$(h.data)}catch(j){var i=h.data}}f.success(i,h.textStatus)}else{f.error(h.textStatus,h.errorThrown)}})},getURL:function(f,g){if(g){g(window.webmynd[e].utils.completeLinks(f))}},openWindow:function(g,f,h){return window.webmynd[e].services.backgroundOpenUrl(g)},UUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){var g=Math.random()*16|0,f=h=="x"?g:(g&3|8);return f.toString(16)}).toUpperCase()},log:function(g,f){if(window.console!==undefined&&console.log){var h=g;if(f){h+="\n\tname:"+f.name+"\n\tmessage:"+f.message;if(f.fileName){h+="\n\tfile:"+f.fileName}if(f.lineNumber){h+="\n\tline:"+f.lineNumber}}console.log("["+e+"] "+h)}},button:{setIcon:function(f){window.webmynd[e].utils.button.setIcon({url:f})},setUrl:function(f){window.webmynd[e].utils.button.setUrl({url:f})},onClicked:{addListener:function(f){window.webmynd[e].services.button.onClicked.addListener(f)}}},prefs:{get:function(f,g){window.webmynd[e].model.getPrefs([f],function(h){if(g){return g(h[f])}})},set:function(f,h){var g={};g[f]=h;return window.webmynd[e].model.setPrefs(g)},keys:function(f){window.webmynd[e].model.prefs.keys(f)},clear:function(f,g){window.webmynd[e].model.prefs.clear([f],g)},clearAll:function(f){window.webmynd[e].model.prefs.clearAll(f)}},getPref:function(f,g){this.prefs.get(f,g)},setPref:function(f,g){this.prefs.set(f,g)},message:{listen:function(f,g){window.webmynd[e].services.onConnect.addListener(function(h){if(h.name==="broadcast-priv"){h.onMessage.addListener(function(k){var j=k.body;if(typeof f==="string"&&j.broadcastType===f){var i=g}else{if(typeof f==="function"){var i=f}}if(i){return i(j.content,function(l){h.postMessage(l)})}})}})},broadcast:function(f,g,h){window.webmynd[e].services.sendRequestToTabs({header:{type:"Broadcast"},body:{broadcastType:f,content:g}},function(i){if(h){h(i)}})},toFocussed:function(f,g,h){window.webmynd[e].services.sendRequestToFocussedTab({header:{type:"ToFocussed"},body:{broadcastType:f,content:g}},function(i){if(h){h(i)}})}},listen:function(f,g){this.message.listen(f,g)},broadcast:function(f,g,h){this.message.broadcast(f,g,h)}}})();(function(){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd[e].onStart.push(function(g,h){const f={};g.getPref("localStorage",function(w){if(!w){w={};g.setPref("localStorage",w)}function u(A,y){const B=[];for(var z=0;z<A;z++){B[z]=y}return B}function o(i){return typeof i=="string"?JSON.parse(i):i}function j(z,C,A){const B=f[z];const E=++B[0];const D=s[z];const i=!D[C][3];const y=o(w.requestsIndicated);if((!A?i:!D[l]||i)&&B[3][C]){if(B[1]&&y){delete B[1]}delete B[3][C]}B[2][C]++;if(E==1){g.getURL(e+"/blocked.png",function(F){g.button.setIcon(F)})}g.getPref("disconnect_data",function(F){F.REQUEST_COUNTS[0]=B;g.setPref("disconnect_data",F)})}const x=Date.now;const p=16;const m=o(w.build);const n=[["Digg",["digg.com"]],["Facebook",["facebook.com","facebook.net","fbcdn.net"]],["Google",["google.com","2mdn.net","doubleclick.net","feedburner.com","gmodules.com","google-analytics.com","googleadservices.com","googlesyndication.com"],["adwords","checkout","chrome","code","docs","feedburner","groups","health","knol","mail","picasaweb","sites","sketchup","wave"],["accounts","analytics","bookmarks","calendar","finance","ig","latitude","reader","voice","webmasters","adsense","alerts","cse","dfp","friendconnect","local","merchants","notebook","support"],"https://www.google.com/"],["Twitter",["twitter.com","twimg.com"]],["Yahoo",["yahoo.com"],["address","answers","apps","buzz","calendar","edit","finance","games","groups","hotjobs","local","mail","my","notepad","pulse","shine","sports","upcoming","webmessenger","www","alerts","autos","avatars","help","login","messages","pipes","realestate","smallbusiness","travel","widgets"],[],"https://search.yahoo.com/"]];const l=n.length;const t="Blocked";const s={};const v=x();var q;if(!o(w.initialized)){for(q=0;q<l;q++){w[n[q][0].toLowerCase()+t]=true}w.requestsIndicated=true;w.initialized=true;g.setPref("localStorage",w)}if(o(w.blockingIndicated)){delete w.blockingIndicated;w.requestsIndicated=true;g.setPref("localStorage",w)}if(!m||m<p){w.boxDecoration=0;w.build=p;g.setPref("localStorage",w)}for(q=0;q<l;q++){var r=n[q];var k=r[4];if(k&&o(w[r[0].toLowerCase()+t])){}}g.listen("disconnect-broadcast",function(E,z){const C=0;var A=s[C];if(E.initialized){if(!A){A=s[C]=[];for(var B=0;B<l;B++){var y=n[B];A[B]=[y[0],y[1],!!y[2],o(w[y[0].toLowerCase()+t])]}A.push(o(w.searchDepersonalized),o(w.boxDecoration));f[C]=[0,true,u(l,0),u(l,true)];g.getPref("disconnect_data",function(i){i.REQUEST_COUNTS=f;g.setPref("disconnect_data",i)})}z({blacklist:A})}else{const D=E.serviceIndex;if(!E.unblocked){j(C,D)}else{delete w[n[D][0].toLowerCase()+t];delete A[D][3];g.setPref("localStorage",w)}z({})}});g.listen("disconnect-reset",function(){delete s[0];delete f[0];g.getPref("disconnect_data",function(i){delete i.REQUEST_COUNTS[0];g.setPref("disconnect_data",i)});g.getURL(e+"/activated.png",function(i){g.button.setIcon(i)})});g.listen("disconnect-toggle-blocked",function(i){g.getPref("localStorage",function(y){w[i.blockedName]=!o(w[i.blockedName]);g.setPref("localStorage",w)})})})})})();window.webmynd[a].uninstall={listener:{onUninstalling:function(e){window.webmynd[a].services.getLocalPref("uninstallprompt","bool",function(f){if(f&&e.id=="disconnect@disconnect.me"){window.webmynd[a].uninstall.action()}})},onDisabling:function(e){window.webmynd[a].services.getLocalPref("uninstallprompt","bool",function(f){if(f&&e.id=="disconnect@disconnect.me"){window.webmynd[a].uninstall.action()}})},onOperationCancelled:function(e){if(e.id=="disconnect@disconnect.me"){}}},action:function(){window.webmynd[a].services.getLocalPref("username","int",function(f){window.open("chrome://"+a+"/content/uninstall.html","uninstall","chrome,width=501,height=330,resizable=yes,scrollbars=no,chrome=yes,centerscreen=yes");message=window.webmynd.userData.browser+window.webmynd.userData.version+window.webmynd.userData.publisher.name;var e=window.webmynd[a].services.newXHR();e.open("GET",window.webmynd.userData.host+"/uninstall_report?user_id="+f+"&message="+message);e.send(null);window.webmynd[a].uninstall.unregister})},observe:function(f,e,g){if(e=="em-action-requested"){f.QueryInterface(Components.interfaces.nsIUpdateItem);window.webmynd[a].services.getLocalPref("uninstallprompt","bool",function(h){if(h&&f.id=="disconnect@disconnect.me"){if(g=="item-uninstalled"||g=="item-disabled"){window.webmynd[a].uninstall.action()}}})}},register:function(){Components.classes["@mozilla.org/observer-service;1"].getService(Components.interfaces.nsIObserverService).addObserver(this,"em-action-requested",false);window.webmynd[a].services.setLocalPref("uninstallprompt","bool",true);try{Components.utils["import"]("resource://gre/modules/AddonManager.jsm");AddonManager&&AddonManager.addAddonListener(window.webmynd[a].uninstall.listener)}catch(f){}},unregister:function(){Components.classes["@mozilla.org/observer-service;1"].getService(Components.interfaces.nsIObserverService).removeObserver(this,"em-action-requested");window.webmynd[a].services.setLocalPref("uninstallprompt","bool",false);try{Components.utils["import"]("resource://gre/modules/AddonManager.jsm");AddonManager&&AddonManager.addAddonListener(window.webmynd[a].uninstall.listener)}catch(f){}}};window.webmynd[a].main={loader:Components.classes["@mozilla.org/moz/jssubscript-loader;1"].getService(Components.interfaces.mozIJSSubScriptLoader),init:function(){if(!window.webmynd[a].$){window.webmynd[a].main.loader.loadSubScript("resource://"+a+"-common/lib/jquery-1.5.1.webmynd.min.js",window.webmynd[a])}Components.classes["@mozilla.org/observer-service;1"].getService(Components.interfaces.nsIObserverService).addObserver({observe:function(u,o,q){if("http-on-modify-request"==o){var t={window:window,win:window.webmynd[a].contentScript,doc:document,inPageScript:true,$:window.webmynd[a].$,evt:{target:[],url:u.QueryInterface(Components.interfaces.nsIHttpChannel).originalURI.spec,referrer:(u.QueryInterface(Components.interfaces.nsIHttpChannel).referrer)?u.QueryInterface(Components.interfaces.nsIHttpChannel).referrer.host:"",host:u.QueryInterface(Components.interfaces.nsIHttpChannel).originalURI.host,document:{},preventDefault:function(){if(u.originalURI.host!=a){u.setRequestHeader("Connection","close",false);u.setRequestHeader("Cookie","",false);if(u.cancel){u.cancel(Components.results.NS_ERROR_ABORT);dump("Disconnect: "+u.originalURI.spec+"\n")}}}}};function s(v){var e=v.split(".");return e.splice(e.length-2,2).join(".")}if(!t.evt.referrer||s(t.evt.host)==s(t.evt.referrer)||s(t.evt.host)==a){return}try{var n=u.notificationCallbacks?u.notificationCallbacks:u.loadGroup.notificationCallbacks;if(n){var p=n.getInterface(Components.interfaces.nsIDOMWindow);if(p){t.evt.document=p.content.document}else{return}}else{return}}catch(r){return}window.webmynd[a].main.loader.loadSubScript("resource://"+a+"/services.js",t);window.webmynd[a].main.loader.loadSubScript("resource://"+a+"-common/utils.js",t);window.webmynd[a].main.loader.loadSubScript("resource://"+a+"-common/api-content.js",t);window.webmynd[a].main.loader.loadSubScript("resource://"+a+"/2b74ff14-7256-42e0-9bf1-0806eec78788/content.js",t);delete t}}},"http-on-modify-request",false);var i=a+"-toolbarbutton";var h="urlbar-container";var g=document.getElementById("nav-bar");var j=g.currentSet.split(",");if(j.indexOf(i)==-1){var m=j.indexOf(h)+1||j.length;var l=j.slice(0,m).concat(i).concat(j.slice(m));g.setAttribute("currentset",l.join(","));g.currentSet=l.join(",");document.persist(g.id,"currentset");try{BrowserToolboxCustomizeDone(true)}catch(k){}}var f=document.getElementById("appcontent");f.addEventListener("DOMContentLoaded",window.webmynd[a].main.onload,true)},uninit:function(){var e=document.getElementById("appcontent");e.removeEventListener("DOMContentLoaded",window.webmynd[a].main.onload,true)},onload:function(e){if(!e.originalTarget.defaultView.frameElement){var g=e.originalTarget.defaultView;g.webmynd=g.webmynd||{};g.webmynd[a]=g.webmynd[a]||{};g.webmynd[a].$=window.webmynd[a].$;var f={window:window,win:g,doc:e.originalTarget,inPageScript:true};window.webmynd[a].main.loader.loadSubScript("resource://"+a+"/services.js",f);window.webmynd[a].main.loader.loadSubScript("resource://"+a+"-common/utils.js",f);window.webmynd[a].main.loader.loadSubScript("resource://"+a+"-common/controller.js",f)}}};window.addEventListener("load",window.webmynd[a].main.init,false);window.addEventListener("unload",window.webmynd[a].main.uninit,false);
/* Copyright 2011 WebMynd Corp. All rights reserved. */
(function(){var e="2b74ff14-7256-42e0-9bf1-0806eec78788";window.webmynd[e].handlers={GetPrefs:function(i,h,g){window.webmynd[e].model.getPrefs(i.names,g)},SetPrefs:function(i,h,g){g(window.webmynd[e].model.setPrefs(i.pairs))},"Prefs-Keys":function(i,h,g){window.webmynd[e].model.prefs.keys(g)},"Prefs-Clear":function(i,h,g){window.webmynd[e].model.prefs.clear(i.names,g)},"Prefs-ClearAll":function(i,h,g){window.webmynd[e].model.prefs.clearAll(g)},GetUrl:function(i,h,g){window.webmynd[e].model.getUrl(i.url,g)},OpenWindow:function(i,h,g){window.webmynd[e].services.backgroundOpenUrl(i.url)},DoAjax:function(i,h,g){window.webmynd[e].model.doAjax(i.options,g)},"Button-SetIcon":function(i,h,g){window.webmynd[e].services.button.setIcon(i.options)},"Button-SetUrl":function(i,h,g){window.webmynd[e].services.button.setUrl(i.options)}};window.webmynd[e].services.onRequest.addListener(function(j,h,g){var i=window.webmynd[e].handlers[j.header.type];if(typeof i==="undefined"){window.webmynd[e].services.console.log("No handler defined for "+j.header.type+" request.")}else{delete j.header;return i(j,h,g)}});window.webmynd[e].services.button.onClicked.addListener(function(g){window.webmynd[e].services.sendRequestToTabs({header:{toPrivileged:false,type:"Broadcast"},body:{broadcastType:"button-click"}})});window.webmynd[e].services.onConnect.addListener(function(g){if(g.name==="broadcast"){g.onMessage.addListener(function(h){window.webmynd[e].services.sendRequestToTabs(h,function(i){g.postMessage(i)})})}});window.webmynd[e].onStart=window.webmynd[e].onStart||[];function f(){window.webmynd[e].model.init(window.webmynd[e].userData);window.webmynd[e].onStart.forEach(function(g){g(window.webmynd[e].api,window.webmynd[e].$)})}window.addEventListener("load",f,false)})()})();